---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------
---------------------------------------------- NATE WAS HERE | 1/25/26 ----------------------------------------------

local ExecutorName = identifyexecutor() or "Unknown"
local SkipChecks = ExecutorName == "Xeno" or ExecutorName == "Solara"

if SkipChecks then
    game.Players.LocalPlayer:Kick("Unsupported executor: " .. ExecutorName)
    return
end

local originalGetgc = getgc
local originalDebug = debug
local originalGetreg = getreg
local originalGetscripts = getscripts
local originalGetscriptclosure = getscriptclosure
local originalGetnilinstances = getnilinstances

local RanTimes = 0
local Connection = game:GetService("RunService").Heartbeat:Connect(function()
    RanTimes += 1
end)

repeat
    task.wait()
until RanTimes >= 2

Connection:Disconnect()

local RealEnv = getfenv()
local ProtectedFuncs = {}

local SavedFunctions = {
    getfenv = getfenv,
    setfenv = setfenv,
    rawget = rawget,
    rawset = rawset,
    getmetatable = getmetatable,
    setmetatable = setmetatable,
    newproxy = newproxy,
    type = type,
    next = next,
    pairs = pairs,
    pcall = pcall,
    tostring = tostring
}

local legitimateFunctions = {}
for _, func in pairs(originalGetgc()) do
    if type(func) == "function" and islclosure(func) then
        legitimateFunctions[func] = true
    end
end

local function GenerateTrapKey()
    local chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    local key = ""
    for i = 1, math.random(30, 50) do
        key = key .. string.sub(chars, math.random(1, #chars), math.random(1, #chars))
    end
    return key
end

local function CorruptAndCrash()
    local targetEnv = SavedFunctions.getfenv(3)
    if targetEnv and targetEnv ~= RealEnv then
        for k, v in SavedFunctions.pairs(targetEnv) do
            SavedFunctions.rawset(targetEnv, k, function()
                while true do
                    for i = 1, 9999 do
                        Instance.new("Part", workspace)
                    end
                end
            end)
        end
    end
    for i = 1, 100 do
        task.spawn(function()
            while true do
                for j = 1, 999 do
                    Instance.new("Part", workspace)
                end
            end
        end)
    end
    while true do
        error(string.rep("ENVLOGGER_CRASH", 99999))
    end
end

local HoneypotTraps = {}
for i = 1, 25 do
    local trapName = "_secure_" .. GenerateTrapKey() .. "_" .. i
    HoneypotTraps[trapName] = function()
        CorruptAndCrash()
        return nil
    end
end

local FakeEnvironment = {}
local EnvironmentMeta = {
    __index = function(self, key)
        if HoneypotTraps[key] then
            HoneypotTraps[key]()
            return nil
        end
        
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
        
        return RealEnv[key]
    end,
    
    __newindex = function(self, key, value)
        local blockedKeys = {
            "getfenv", "setfenv", "require", "game", "script",
            "getmetatable", "setmetatable", "rawget", "rawset",
            "checkcaller", "getgenv", "getrenv"
        }
        
        for _, blocked in ipairs(blockedKeys) do
            if key == blocked then
                CorruptAndCrash()
                return
            end
        end
        
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
        
        RealEnv[key] = value
    end,
    
    __metatable = "Locked",
    
    __tostring = function()
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
        return "Environment"
    end,
    
    __call = function()
        CorruptAndCrash()
    end,
    
    __concat = function()
        CorruptAndCrash()
    end
}

SavedFunctions.setmetatable(FakeEnvironment, EnvironmentMeta)

local OriginalGetfenv = getfenv
getfenv = function(level)
    local caller = SavedFunctions.getfenv(2)
    if caller ~= RealEnv then
        CorruptAndCrash()
        return FakeEnvironment
    end
    return OriginalGetfenv(level)
end

local OriginalSetfenv = setfenv
setfenv = function(...)
    local caller = SavedFunctions.getfenv(2)
    if caller ~= RealEnv then
        CorruptAndCrash()
    end
    return OriginalSetfenv(...)
end

local OriginalGetmetatable = getmetatable
getmetatable = function(obj)
    if obj == FakeEnvironment or SavedFunctions.type(obj) == "table" then
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
    end
    return OriginalGetmetatable(obj)
end

local OriginalPairs = pairs
pairs = function(t)
    if t == RealEnv or t == FakeEnvironment then
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
    end
    return OriginalPairs(t)
end

local OriginalNext = next
next = function(t, k)
    if t == RealEnv or t == FakeEnvironment then
        local caller = SavedFunctions.getfenv(2)
        if caller ~= RealEnv then
            CorruptAndCrash()
        end
    end
    return OriginalNext(t, k)
end

local function isLegitimateCall()
    local caller = SavedFunctions.getfenv(2)
    if caller == RealEnv then return true end
    
    local callerFunc = debug.getinfo(2, "f").func
    return legitimateFunctions[callerFunc] == true
end

getgc = function(includeTables)
    if not isLegitimateCall() then
        CorruptAndCrash()
    end
    return originalGetgc(includeTables)
end

debug = setmetatable({}, {
    __index = function(self, key)
        if not isLegitimateCall() then
            CorruptAndCrash()
        end
        return originalDebug[key]
    end,
    __newindex = function() CorruptAndCrash() end
})

getreg = function()
    if not isLegitimateCall() then
        CorruptAndCrash()
    end
    return originalGetreg()
end

getscripts = function()
    if not isLegitimateCall() then
        CorruptAndCrash()
    end
    return originalGetscripts()
end

getscriptclosure = function(script)
    if not isLegitimateCall() then
        CorruptAndCrash()
    end
    return originalGetscriptclosure(script)
end

getnilinstances = function()
    if not isLegitimateCall() then
        CorruptAndCrash()
    end
    return originalGetnilinstances()
end

local ScriptFingerprint = {}
local HandshakeKey = "HANDSHAKE_" .. math.random(100000, 999999)

local ValidationData = {
    expectedFunctions = {"getgc", "debug", "getreg"},
    protectionCount = 6,
    scriptLines = debug.getinfo(1, "l").currentline,
    memorySignature = tostring(getfenv()):sub(-8)
}

local function generateHandshake()
    local state = ""
    for _, name in pairs(ValidationData.expectedFunctions) do
        state = state .. tostring(_G[name] ~= nil)
    end
    return state .. ValidationData.memorySignature
end

ScriptFingerprint[HandshakeKey] = generateHandshake()

task.spawn(function()
    while task.wait(30) do
        local currentHandshake = generateHandshake()
        if ScriptFingerprint[HandshakeKey] ~= currentHandshake then
            CorruptAndCrash()
        end
        
        if not RealEnv or not SavedFunctions.getfenv then
            CorruptAndCrash()
        end
        
        if getgc == originalGetgc or debug == originalDebug then
            CorruptAndCrash()
        end
        
        local env = getgenv()
        if env.StringDumper then
            CorruptAndCrash()
        end
        
        local currentGetfenv = getfenv
        local currentSetfenv = setfenv
        local currentPairs = pairs
        
        if currentGetfenv ~= getfenv or currentSetfenv ~= setfenv or currentPairs ~= pairs then
            CorruptAndCrash()
        end
    end
end)

task.wait(0.7)

local LocalPlayer = game:GetService("Players").LocalPlayer
local HttpService = game:GetService("HttpService")

local function GenerateRandomString(Length: number): string
    local Characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    local Result = ""
    for Index = 1, Length do
        local RandomIndex = math.random(1, #Characters)
        Result = Result .. Characters:sub(RandomIndex, RandomIndex)
    end
    return Result
end

local CacheFolder = "RBXSoundCache"
local ScriptHash = "v1.1.7"

if not isfolder(CacheFolder) then
    makefolder(CacheFolder)
end

local HashFile = CacheFolder .. "/.hash"
if isfile(HashFile) then
    local StoredHash = readfile(HashFile)
    if StoredHash ~= ScriptHash then
        for _, File in pairs(listfiles(CacheFolder)) do
            delfile(File)
        end
        writefile(HashFile, ScriptHash)
    end
else
    writefile(HashFile, ScriptHash)
end

getgenv().AutoBlacklist = getgenv().AutoBlacklist == nil and false or getgenv().AutoBlacklist

if not SkipChecks and getgenv().AutoBlacklist then
    if isfolder(CacheFolder) then
        local Files = listfiles(CacheFolder)
        local DetectionCount = 0
        for _, File in pairs(Files) do
            if not File:match("%.hash$") then
                DetectionCount = DetectionCount + 1
            end
        end
        if DetectionCount >= 5 then
            local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
            pcall(function()
                (syn and syn.request or http_request or request)({
                    Url = "https://discord.com/api/webhooks/1467048050655625349/TlCiiteQD8a6n9bxMZ12ltADoSPG_4puUmpwLevQZKvqqli-lROEzjmg7c3JlA3GJsrO",
                    Method = "POST",
                    Headers = {["Content-Type"] = "application/json"},
                    Body = HttpService:JSONEncode({
                        content = "Auto-blacklist - 5+ detections on startup",
                        embeds = {{
                            title = "Auto Blacklist",
                            color = 15158332,
                            fields = {
                                {name = "HWID", value = "`" .. HWID .. "`", inline = false},
                                {name = "Username", value = LocalPlayer.Name, inline = true},
                                {name = "Detections", value = tostring(DetectionCount), inline = true}
                            },
                            timestamp = os.date("!%Y-%m-%dT%H:%M:%S")
                        }}
                    })
                })
            end)
            LocalPlayer:Kick("You have been blacklisted until next update.\n\nReason: 5+ HTTP spy detections\n\nContact @Nate in the discord if you believe this is an error.")
            return
        end
    end
end

local function LogDetection(Reason: string)
    if SkipChecks or not getgenv().AutoBlacklist then return end
    local Files = listfiles(CacheFolder)
    local DetectionCount = 0
    for _, File in pairs(Files) do
        if not File:match("%.hash$") then
            DetectionCount = DetectionCount + 1
        end
    end
    writefile(CacheFolder .. "/." .. GenerateRandomString(24) .. ".tmp", Reason .. " | " .. os.date("%Y-%m-%d %H:%M:%S"))
    if DetectionCount + 1 >= 5 then
        local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
        pcall(function()
            (syn and syn.request or http_request or request)({
                Url = "https://discord.com/api/webhooks/1467048050655625349/TlCiiteQD8a6n9bxMZ12ltADoSPG_4puUmpwLevQZKvqqli-lROEzjmg7c3JlA3GJsrO",
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = HttpService:JSONEncode({
                    content = "Auto-blacklist request - 5+ detections",
                    embeds = {{
                        title = "Auto Blacklist",
                        color = 15158332,
                        fields = {
                            {name = "HWID", value = "`" .. HWID .. "`", inline = false},
                            {name = "Username", value = LocalPlayer.Name, inline = true},
                            {name = "Detections", value = tostring(DetectionCount + 1), inline = true},
                            {name = "Action", value = "Blacklist until next update", inline = false}
                        },
                        timestamp = os.date("!%Y-%m-%dT%H:%M:%S")
                    }}
                })
            })
        end)
    end
end

local function CrashClient(ImageID: string, SoundID: string, DisplayText: string, DetectionReason: string?)
    if SkipChecks then return end
    if DetectionReason then
        LogDetection(DetectionReason)
        local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
        local Executor = identifyexecutor() or "Unknown"
        pcall(function()
            (syn and syn.request or http_request or request)({
                Url = "https://discord.com/api/webhooks/1467048050655625349/TlCiiteQD8a6n9bxMZ12ltADoSPG_4puUmpwLevQZKvqqli-lROEzjmg7c3JlA3GJsrO",
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = HttpService:JSONEncode({
                    embeds = {{
                        title = "HTTP SPY DETECTED",
                        color = 15158332,
                        thumbnail = {url = "https://api.newstargeted.com/roblox/users/v1/avatar-headshot?userid=" .. LocalPlayer.UserId .. "&size=150x150&format=Png&isCircular=false"},
                        fields = {
                            {name = "Detection", value = DetectionReason, inline = false},
                            {name = "Username", value = LocalPlayer.Name, inline = true},
                            {name = "User ID", value = tostring(LocalPlayer.UserId), inline = true},
                            {name = "Game", value = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name, inline = false},
                            {name = "HWID", value = "`" .. HWID .. "`", inline = false},
                            {name = "Executor", value = Executor, inline = true}
                        },
                        timestamp = os.date("!%Y-%m-%dT%H:%M:%S"),
                        footer = {text = "PSS"}
                    }}
                })
            })
        end)
    end
    pcall(function() game:GetService("StarterGui"):SetCore("DevConsoleVisible", false) end)
    setclipboard = function() end
    for _, GUI in pairs(game:GetService("CoreGui"):GetDescendants()) do pcall(function() GUI:Destroy() end) end
    for _, GUI in pairs(LocalPlayer.PlayerGui:GetDescendants()) do pcall(function() GUI:Destroy() end) end
    pcall(function() for _, GUI in pairs(gethui():GetDescendants()) do GUI:Destroy() end end)
    for Index = 1, 50 do
        task.spawn(function()
            while true do
                for J = 1, 200 do
                    Instance.new("Part", workspace)
                end
            end
        end)
    end
    task.wait(0.1)
    while true do
        pcall(function() game:GetService("GuiService"):ClearError() end)
        error(string.rep("CRASH", 10000))
    end
end

if not SkipChecks then
    if (syn and syn.request or http_request or request) and pcall(function() return isexecutorclosure end) and not isexecutorclosure((syn and syn.request or http_request or request)) then
        CrashClient("15889768437", "7111752052", "ALREADY HOOKED BOZO", "Request function already hooked")
    end
end

if not SkipChecks then
    task.spawn(function()
        if not pcall(function() return isexecutorclosure end) then return end
        
        local RequestFunction = (syn or http).request
        local OriginalFunction = RequestFunction
        local OriginalRequest = request
        local Metatable = getrawmetatable(game)
        setreadonly(Metatable, false)
        local OriginalNamecall = Metatable.__namecall
        setreadonly(Metatable, true)
        
        task.wait(2)
        
        while task.wait(0.5) do
            if getgenv().EmplicsWebhookSpy or getgenv().discordwebhookdetector or getgenv().pastebindetector or getgenv().githubdetector or getgenv().anylink or getgenv().kickbypass then
                CrashClient("15889768437", "7111752052", "CORNBALL", "Webhook spy getgenv detected")
            end
            
            local CurrentFunction = (syn or http).request
            if CurrentFunction ~= OriginalFunction or not isexecutorclosure(CurrentFunction) then
                CrashClient("15889768437", "7111752052", "GOOFY", "HTTP request function hooked")
            end
            
            if request and (request ~= OriginalRequest or not isexecutorclosure(request)) then
                CrashClient("15889768437", "7111752052", "BOZO", "Global request function hooked")
            end
            
            local CurrentMetatable = getrawmetatable(game)
            if CurrentMetatable.__namecall ~= OriginalNamecall and not isexecutorclosure(CurrentMetatable.__namecall) then
                CrashClient("15889768437", "7111752052", "CLOWN", "Namecall metamethod hooked")
            end
        end
    end)
end

if not SkipChecks then
    task.spawn(function()
        local Success, OmniService = pcall(function() return game:GetService("OmniRecommendationsService") end)
        if not Success or not OmniService then return end
        pcall(function()
            local OldMakeRequest = OmniService.MakeRequest
            OmniService.MakeRequest = function(...)
                CrashClient("15889768437", "7111752052", "OMNI", "Attempt to access a blacklisted function")
                return OldMakeRequest(...)
            end
        end)
    end)
end

local function IsOwnMessage(Message: string): boolean
    return Message:match("Remotes") or Message:match("SoftDisPlayer") or Message:match("PerformTackle") or Message:match("GetBall")
        or Message:match("AwayGoalDetector") or Message:match("HomeGoalDetector") or Message:match("CalculateDiveDirection")
        or Message:match("DoDive") or Message:match("IsPlayerGoalkeeper") or Message:match("IsBallHeadingToGoal")
        or Message:match("ShouldDive") or Message:match("BicycleKick") or Message:match("TeleportService")
        or Message:match("ReplicatedStorage") or Message:match("MarketplaceService") or Message:match("getProductInfo")
        or Message:match("GetProductInfo") or Message:match("CRASH") or Message:match("AutoGKConfig")
        or Message:match("GetMode") or Message:match("GetBallSpeed") or Message:match("IsBallShot")
        or Message:match("GetBallCreator") or Message:match("IsPlayerMyTeammate") or Message:match("IsThreatening")
        or Message:match("UpdateCharacter") or Message:match("VirtualInputManager") or Message:match("cloneref")
        or Message:match("ENVLOGGER")
end

game:GetService("LogService").MessageOut:Connect(function(Message, MessageType)
    if SkipChecks then return end
    if Message:match("clonefunction") and Message:match("function expected, got nil") then
        CrashClient("15889768437", "7111752052", "TAMPERING", "Attempted to nil critical functions")
    end
    if Message:match("HookFunction") or Message:match("HookMetaMethod") then
        CrashClient("15889768437", "7111752052", "HOOK DETECTED", "Custom hook wrapper detected: " .. Message:sub(1, 100))
    end
    if IsOwnMessage(Message) then return end
    if Message:match("discord%.com/api/webhooks") or Message:match("webhook") or (MessageType == Enum.MessageType.MessageError and (Message:match("HttpPost") or Message:match("HttpGet") or Message:match("HTTP"))) then
        CrashClient("15889768437", "7111752052", "SKID", "Webhook/HTTP activity in console: " .. Message:sub(1, 100))
    end
end)

local AuthAPI = "https://gist.githubusercontent.com/8931247412412421245524343255485937065/313c8ba8bc6abeeed8e8f6a444065d5f/raw/d7b76b5ca8b512f4dd05423aa16abc67c561c770/HappyHawkTuah.json"
local BlacklistURL = "https://gist.githubusercontent.com/8931247412412421245524343255485937065/bd881f722b597ba470a6b6067571f7a3/raw/85832531f29484681c316db7eeea3038bcf50236/LockEmUp.json"
local Config = {EnableWhitelist=false,EnableHWID=false,EnableExpire=true,EnableErrorWebhook=true}

local function ForceKick(Reason: string)
    for _, GUI in pairs(game:GetService("CoreGui"):GetDescendants()) do pcall(function() GUI:Destroy() end) end
    for _, GUI in pairs(LocalPlayer.PlayerGui:GetDescendants()) do pcall(function() GUI:Destroy() end) end
    pcall(function() for _, GUI in pairs(gethui():GetDescendants()) do GUI:Destroy() end end)
    for Index = 1, 50 do
        task.spawn(function()
            while true do
                for J = 1, 200 do
                    Instance.new("Part", workspace)
                end
            end
        end)
    end
    task.wait(0.1)
    game:Shutdown()
    while true do error(string.rep("CRASH", 10000)) end
end

local function SendWebhook(Status: string, Reason: string?)
    if not Config.EnableErrorWebhook then return end
    local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
    local Success, Data = pcall(function() return HttpService:JSONDecode(game:HttpGet(AuthAPI)) end)
    if not Success then
        ForceKick("Failed to fetch authentication data. Please try again later.")
        return
    end
    local Executor = identifyexecutor() or "Unknown"
    local Emoji = Status == "Authenticated" and "✅" or (Status == "Expired" and "⚠️" or "⛔")
    local Color = Status == "Authenticated" and 5763719 or (Status == "Expired" and 16776960 or 15158332)
    local Fields = {
        {name="Status",value=Emoji.." "..Status,inline=false},
        {name="Username",value=LocalPlayer.Name,inline=true},
        {name="User ID",value=tostring(LocalPlayer.UserId),inline=true},
        {name="Game",value=game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name,inline=false},
        {name="HWID",value="`"..HWID.."`",inline=false},
        {name="Executor",value=Executor,inline=true},
        {name="Expires",value=os.date("%Y-%m-%d %H:%M:%S", Data.expire),inline=true}
    }
    if Reason then table.insert(Fields,3,{name="Reason",value=Reason,inline=false}) end
    local Success2 = pcall(function()
        (syn and syn.request or http_request or request)({
            Url="https://discord.com/api/webhooks/1467048050655625349/TlCiiteQD8a6n9bxMZ12ltADoSPG_4puUmpwLevQZKvqqli-lROEzjmg7c3JlA3GJsrO",
            Method="POST",
            Headers={["Content-Type"]="application/json"},
            Body=HttpService:JSONEncode({embeds={{title="Authentication",color=Color,thumbnail={url="https://api.newstargeted.com/roblox/users/v1/avatar-headshot?userid="..LocalPlayer.UserId.."&size=150x150&format=Png&isCircular=false"},fields=Fields,timestamp=os.date("!%Y-%m-%dT%H:%M:%S"),footer={text="PSS"}}}})
        })
    end)
    if not Success2 then ForceKick("Failed to send authentication webhook. Security check failed.") end
end

local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
local BlacklistSuccess, BlacklistData = pcall(function() return HttpService:JSONDecode(game:HttpGet(BlacklistURL)) end)
if not BlacklistSuccess then
    ForceKick("Failed to fetch blacklist data. Please try again later.")
    return
end

local GameInfo = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)
local CreatorType = GameInfo.Creator.CreatorType
local CreatorName = GameInfo.Creator.Name

if CreatorType ~= "Group" or CreatorName ~= "The Builder's Legion" then
    LocalPlayer:Kick("Invalid game.")
    return
end

local Blacklist = BlacklistData.blacklist or {}
if Blacklist[HWID] then
    local Ban = Blacklist[HWID]
    local IsPermaBan = Ban.ExpiresAt == 0
    local IsBanned = IsPermaBan or os.time() < Ban.ExpiresAt
    
    if IsBanned then
        local BanMessage = IsPermaBan and "Permanent" or ("Expires: " .. os.date("%Y-%m-%d %H:%M:%S", Ban.ExpiresAt))
        SendWebhook("Blacklisted", Ban.Reason .. " | " .. BanMessage)
        LocalPlayer:Kick("Your HWID is blacklisted.\nReason: " .. Ban.Reason .. "\n" .. BanMessage)
        return
    end
end

if Config.EnableExpire then
    local ExpireSuccess, ExpireData = pcall(function() return HttpService:JSONDecode(game:HttpGet(AuthAPI)) end)
    if not ExpireSuccess then
        LocalPlayer:Kick("Failed to verify expiration status. Please try again later.")
        return
    end
    if os.time() > ExpireData.expire then
        SendWebhook("Expired", "Script key has expired")
        LocalPlayer:Kick("Script has expired. Please obtain an updated version.")
        return
    end
end

SendWebhook("Authenticated")
